#!/usr/bin/php

<?php

/**
 * Copyright 2018 Peter Streltsov
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License
 */

use streltcov\YandexGeocoder\GeoCoder;

system('clear');

$autoload = '../vendor/autoload.php';
require_once $autoload;

/**
 * @param string $address
 */
$requestaddress = function ($address) {
    system('clear');
    $coder = GeoCoder::search($address);

    $getexact = function ()
    {

    };

    $command = 0;
    while ($command != 7) {
        echo "Data requested" . PHP_EOL;
        echo PHP_EOL;
        echo "1 - get exact value" . PHP_EOL;
        echo "7 - go back". PHP_EOL;
        $command = trim(fgets(STDIN));
        switch ($command) {
            case '1':
                echo PHP_EOL;
                echo "exact value - " . $coder->getExact()->name;
                break;
            case '7':
                system('clear');
                return;
                break;
        }
    }

};


/**
 * @param string $coordinates
 */
$requestcontext = function ($coordinates) {

};

while (true) {

    echo PHP_EOL;
    echo "1 - request address data" . PHP_EOL;
    echo "2 - request context data (coordinates)" . PHP_EOL;
    echo "3 - exit" . PHP_EOL;
    echo "(default - 1): ";
    $answer = trim(fgets(STDIN));

    switch ($answer) {
        case '1':
            echo "Type address to request data:";
            $address = trim(fgets(STDIN));
            $requestaddress($address);
            break;
        case '2':
            echo "Type coordinates to request context data:";
            $coordinates = trim(fgets(STDIN));
            $requestcontext($coordinates);
            break;
        case'3':
            system('clear');
            exit();
        default:
            break;
    }

    system('clear');

}
